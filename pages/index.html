<!DOCTYPE html>
<html>
  <head>
    <title>Dash</title>
    <meta charset="UTF-8">
    <meta name="author" content="Jack Sarick">
    <style type="text/css">
      <<< /css/bulma.min.css >>>
      <<< /css/layout.css >>>
    </style>
    <script type="text/javascript">
      <<< /js/charts.min.js >>>
      <<< /js/colours.js >>>

      const sum_data = <<< /data/aggregate.json >>>;

      // Doctor the data
      agg_data = sum_data.map(arr =>
        arr.data.filter(dp => ((dp.spend*100) % 113) == 0)
      )

      agg_data[0] = agg_data[0].concat(agg_data[0], agg_data[0])
      agg_data[1] = agg_data[1].concat(agg_data[1])
    </script>
  </head>
  <body>

    <!-- Main Header -->
    <section class="hero is-primary is-bold">
      <div class="hero-body">
        <div class="container">
          <div class="columns">
            <div class="column one-quarter">
              <img src="https://placehold.it/300x100?text=Dashboard+by+Rush" alt="">
            </div>
            <div class="column">
            </div>
            <div class="column is-1">
             <a class="button is-info is-outlined">Account</a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Jumbotron -->
    <section class="section is-medium">
      <!-- Main Jumbotron -->
      <div class="container">
        <div class="heading">
          <h1 class="title">Progress Overview:</h1>
          <div class="columns">
            <!-- Left bit -->
            <div class="column is-1"></div>

            <!-- Middle bit -->
            <div class="column">
              <div class="buffer"></div>
              <progress class="progress is-success is-x-large battle" value="{{{ complete-percent }}}" max="100">{{{ complete-percent }}}%</progress>
              <div class="buffer"></div>
              <center>
                <h1 class="subtitle is-1">You are <b>{{{ complete-percent }}}%</b> of the way to your daily goal of {{{ ideal-people }}}</h1>
              </center>
            </div>

            <!-- Right bit -->
            <div class="column is-1"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Rest of the page -->
    <section class="section columns charts">
      <!-- Info -->
      <div class="column is-one-half">
        <center><h2 class="title is-2">Explore Data</h2></center>
        <div class="buffer"></div>
        <h2 class="title is-2">
          Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
          tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
          quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
          consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
          cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
          proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
        </h2>
      </div>
      
      <!-- Polar -->
      <div class="column is-one-half">
        <div class="buffer"></div>
        <canvas id="polar-chart"></canvas>
        <script type="text/javascript">
          var ctx = document.getElementById("polar-chart");

          const devices = ["Mobile", "Desktop", "App"];

          var data = {
            labels: devices,

            datasets: [
              {
                data: devices.map(x => 
                  agg_data[0].filter(d => d["platform"] == x.toLowerCase()).length
                ),
                backgroundColor: [
                  colour.green,
                  colour.blue,
                  colour.yellow
                ],
              }]
          };

          var pieChart = new Chart(ctx,{
            type: 'polarArea',
            data: data
          });
        </script>
      </div>
    </section>
  </body>
</html>
